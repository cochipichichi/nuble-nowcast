<!doctype html><html lang="es" data-theme="dark"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Ñuble Nowcast</title>
<link rel="manifest" href="public/manifest.webmanifest"><link rel="icon" href="assets/icons/icon-192.png">
<link rel="stylesheet" href="css/style.css"></head><body>
<header class="header"><div class="brand"><span class="logo"></span><strong>Ñuble Nowcast</strong></div>
<nav><a class="btn" href="./map.html">🗺️ Mapa</a> <a class="btn" href="./history.html">📚 Historial</a> <a class="btn" href="./kiosk.html">📺 Kiosko</a></nav></header>
<main class="container">
<section class="card"><h1>🌪️ Dashboard</h1>
<div class="grid cards">
<div class="card"><h3>🌧️ Lluvia</h3><canvas id="rain" style="width:100%;height:180px"></canvas></div>
<div class="card"><h3>💨 Viento</h3><canvas id="wind" style="width:100%;height:180px"></canvas></div>
<div class="card"><h3>🌡️ Temperatura</h3><canvas id="temp" style="width:100%;height:180px"></canvas></div>
<div class="card"><h3>🌬️ Ráfagas (24h)</h3><canvas id="gusts" style="width:100%;height:90px"></canvas><p class="meta">Máx: <span id="gmax">–</span> m/s</p></div>
</div></section></main>
<script type="module">
import {COMMUNES,getNowcastLive,getGustsLive} from './js/data/live.js';
const selCommIndex=0; const C=COMMUNES[selCommIndex];
function draw(id,data,color){const el=document.getElementById(id);const ctx=el.getContext('2d');const w=el.width=el.clientWidth,h=el.height;ctx.clearRect(0,0,w,h);ctx.strokeStyle=color;ctx.lineWidth=2;ctx.beginPath();data.forEach((v,i)=>{const x=i*(w/(data.length-1));const y=h-(v/Math.max(...data))*h*0.9-h*0.05;i?ctx.lineTo(x,y):ctx.moveTo(x,y)});ctx.stroke();}
(async()=>{const n=await getNowcastLive(C.lat,C.lon);draw('rain',n.series.rain_mm,'#7aa2f7');draw('wind',n.series.wind_ms,'#f2cc60');draw('temp',n.series.temp_c,'#f57');const g=await getGustsLive(C.lat,C.lon);draw('gusts',g.values,'#ccc');document.getElementById('gmax').textContent=g.max.toFixed(1);})();
</script>
</body></html>